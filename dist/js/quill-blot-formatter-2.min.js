!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Quill")):"function"==typeof define&&define.amd?define(["Quill"],e):"object"==typeof exports?exports.QuillBlotFormatter2=e(require("Quill")):t.QuillBlotFormatter2=e(t.Quill)}(self,(t=>(()=>{"use strict";var e={796:(t,e,i)=>{i.r(e),i.d(e,{default:()=>a});var r=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===o}(t)}(t)},o="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(t,e){return!1!==e.clone&&e.isMergeableObject(t)?l((i=t,Array.isArray(i)?[]:{}),t,e):t;var i}function s(t,e,i){return t.concat(e).map((function(t){return n(t,i)}))}function l(t,e,i){(i=i||{}).arrayMerge=i.arrayMerge||s,i.isMergeableObject=i.isMergeableObject||r;var o=Array.isArray(e);return o===Array.isArray(t)?o?i.arrayMerge(t,e,i):function(t,e,i){var r={};return i.isMergeableObject(t)&&Object.keys(t).forEach((function(e){r[e]=n(t[e],i)})),Object.keys(e).forEach((function(o){i.isMergeableObject(e[o])&&t[o]?r[o]=l(t[o],e[o],i):r[o]=n(e[o],i)})),r}(t,e,i):n(e,i)}l.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,i){return l(t,i,e)}),{})};const a=l},797:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(i(1)),n=r(i(796)),s=r(i(402)),l=i(87),a=(t,e)=>e;e.default=class{constructor(t,e={}){this.onClick=()=>{this.hide()},this.quill=t,this.options=(0,n.default)(s.default,e,{arrayMerge:a}),this.currentSpec=null,this.actions=[],this.overlay=document.createElement("div"),this.overlay.classList.add(this.options.overlay.className),this.options.overlay.style&&Object.assign(this.overlay.style,this.options.overlay.style),document.execCommand("enableObjectResizing",!1,"false"),this.quill.root.parentNode.style.position=this.quill.root.parentNode.style.position||"relative",this.quill.root.addEventListener("click",this.onClick),this.specs=this.options.specs.map((t=>new t(this))),this.specs.forEach((t=>t.init())),o.default.register({"formats/imageAlign":l.ImageAlign,"formats/iframeAlign":l.IframeAlignClass,"attributors/class/iframeAlign":l.IframeAlignClass},!0)}show(t){this.currentSpec=t,this.currentSpec.setSelection(),this.setUserSelect("none"),this.quill.root.parentNode.appendChild(this.overlay),this.repositionOverlay(),this.createActions(t)}hide(){this.currentSpec&&(this.currentSpec.onHide(),this.currentSpec=null,this.quill.root.parentNode.removeChild(this.overlay),this.overlay.style.setProperty("display","none"),this.setUserSelect(""),this.destroyActions())}update(){this.repositionOverlay(),this.actions.forEach((t=>t.onUpdate()))}createActions(t){this.actions=t.getActions().map((t=>(t.onCreate(),t)))}destroyActions(){this.actions.forEach((t=>t.onDestroy())),this.actions=[]}repositionOverlay(){if(!this.currentSpec)return;const t=this.currentSpec.getOverlayElement();if(!t)return;const e=this.quill.root.parentNode,i=t.getBoundingClientRect(),r=e.getBoundingClientRect();Object.assign(this.overlay.style,{display:"block",left:`${i.left-r.left-1+e.scrollLeft}px`,top:`${i.top-r.top+e.scrollTop}px`,width:`${i.width}px`,height:`${i.height}px`})}setUserSelect(t){["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"].forEach((e=>{this.quill.root.style.setProperty(e,t),document.documentElement&&document.documentElement.style.setProperty(e,t)}))}}},402:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(i(329)),n=r(i(643)),s={specs:[o.default,n.default],overlay:{className:"blot-formatter__overlay",style:{position:"absolute",boxSizing:"border-box",border:"1px dashed #444"}},align:{attribute:"data-align",aligner:{applyStyle:!0},icons:{left:'\n        <svg viewbox="0 0 18 18">\n          <line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"></line>\n        </svg>\n      ',center:'\n        <svg viewbox="0 0 18 18">\n           <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"></line>\n        </svg>\n      ',right:'\n        <svg viewbox="0 0 18 18">\n          <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"></line>\n        </svg>\n      '},toolbar:{allowDeselect:!0,mainClassName:"blot-formatter__toolbar",mainStyle:{position:"absolute",top:"-12px",right:"0",left:"0",height:"0",minWidth:"100px",font:"12px/1.0 Arial, Helvetica, sans-serif",textAlign:"center",color:"#333",boxSizing:"border-box",cursor:"default",zIndex:"1"},buttonClassName:"blot-formatter__toolbar-button",addButtonSelectStyle:!0,buttonStyle:{display:"inline-block",width:"24px",height:"24px",background:"white",border:"1px solid #999",verticalAlign:"middle"},svgStyle:{display:"inline-block",width:"24px",height:"24px",background:"white",border:"1px solid #999",verticalAlign:"middle"}}},resize:{handleClassName:"blot-formatter__resize-handle",handleStyle:{position:"absolute",height:"12px",width:"12px",backgroundColor:"white",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80"}}};e.default=s},572:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.formatter=t}onCreate(){}onDestroy(){}onUpdate(){}}},751:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(i(1)),n=r(i(572));class s extends n.default{constructor(){super(...arguments),this.onKeyUp=t=>{if(this.formatter.currentSpec&&("Delete"===t.code||"Backspace"===t.code)){const t=this.formatter.currentSpec.getTargetElement();if(t){const e=o.default.find(t);if(e){const t=this.formatter.quill.getIndex(e);this.formatter.quill.deleteText(t,1)}}this.formatter.hide()}}}onCreate(){document.addEventListener("keyup",this.onKeyUp,!0),this.formatter.quill.root.addEventListener("input",this.onKeyUp,!0)}onDestroy(){document.removeEventListener("keyup",this.onKeyUp),this.formatter.quill.root.removeEventListener("input",this.onKeyUp)}}e.default=s},108:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(i(572));class n extends o.default{constructor(t){super(t),this.onMouseDown=t=>{if(!(t.target instanceof HTMLElement))return;if(this.dragHandle=t.target,this.setCursor(this.dragHandle.style.cursor),!this.formatter.currentSpec)return;const e=this.formatter.currentSpec.getTargetElement();if(!e)return;const i=e.getBoundingClientRect();this.dragStartX=t.clientX,this.preDragWidth=i.width,this.targetRatio=i.height/i.width,document.addEventListener("mousemove",this.onDrag),document.addEventListener("mouseup",this.onMouseUp)},this.onDrag=t=>{if(!this.formatter.currentSpec)return;const e=this.formatter.currentSpec.getTargetElement();if(!e)return;const i=t.clientX-this.dragStartX;let r=0;r=this.dragHandle===this.topLeftHandle||this.dragHandle===this.bottomLeftHandle?Math.round(this.preDragWidth-i):Math.round(this.preDragWidth+i);const o=this.targetRatio*r;e.setAttribute("width",`${r}`),e.setAttribute("height",`${o}`),this.formatter.update()},this.onMouseUp=()=>{this.setCursor(""),document.removeEventListener("mousemove",this.onDrag),document.removeEventListener("mouseup",this.onMouseUp)},this.topLeftHandle=this.createHandle("top-left","nwse-resize"),this.topRightHandle=this.createHandle("top-right","nesw-resize"),this.bottomRightHandle=this.createHandle("bottom-right","nwse-resize"),this.bottomLeftHandle=this.createHandle("bottom-left","nesw-resize"),this.dragHandle=null,this.dragStartX=0,this.preDragWidth=0,this.targetRatio=0}onCreate(){this.formatter.overlay.appendChild(this.topLeftHandle),this.formatter.overlay.appendChild(this.topRightHandle),this.formatter.overlay.appendChild(this.bottomRightHandle),this.formatter.overlay.appendChild(this.bottomLeftHandle);const t=this.formatter.options.resize.handleStyle||{};this.repositionHandles(t)}onDestroy(){this.setCursor(""),this.formatter.overlay.removeChild(this.topLeftHandle),this.formatter.overlay.removeChild(this.topRightHandle),this.formatter.overlay.removeChild(this.bottomRightHandle),this.formatter.overlay.removeChild(this.bottomLeftHandle)}createHandle(t,e){const i=document.createElement("div");return i.classList.add(this.formatter.options.resize.handleClassName),i.setAttribute("data-position",t),i.style.cursor=e,this.formatter.options.resize.handleStyle&&Object.assign(i.style,this.formatter.options.resize.handleStyle),i.addEventListener("mousedown",this.onMouseDown),i}repositionHandles(t){let e="0px",i="0px";t&&(t.width&&(e=-parseFloat(t.width)/2+"px"),t.height&&(i=-parseFloat(t.height)/2+"px")),Object.assign(this.topLeftHandle.style,{left:e,top:i}),Object.assign(this.topRightHandle.style,{right:e,top:i}),Object.assign(this.bottomRightHandle.style,{right:e,bottom:i}),Object.assign(this.bottomLeftHandle.style,{left:e,bottom:i})}setCursor(t){if(document.body&&(document.body.style.cursor=t),this.formatter.currentSpec){const e=this.formatter.currentSpec.getOverlayElement();e&&(e.style.cursor=t)}}}e.default=n},737:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(i(572)),n=r(i(185)),s=r(i(320));class l extends o.default{constructor(t){super(t),this.aligner=new n.default(t.options.align,t),this.toolbar=new s.default}onCreate(){const t=this.toolbar.create(this.formatter,this.aligner);this.formatter.overlay.appendChild(t)}onDestroy(){const t=this.toolbar.getElement();t&&(this.formatter.overlay.removeChild(t),this.toolbar.destroy())}}e.default=l},87:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ImageAlign=e.IframeAlignClass=e.InlineBlot=void 0;const o=r(i(1));e.InlineBlot=o.default.import("blots/inline");const n=o.default.import("parchment"),{ClassAttributor:s,Scope:l}=n,a=new s("iframeAlign","ql-iframe-align",{scope:l.BLOCK,whitelist:["left","center","right"]});e.IframeAlignClass=a;class c extends e.InlineBlot{static create(t){const e=super.create();return t?(e.classList.remove(`${this.className}`),e.classList.add(`${this.className}-${t}`)):Array.from(e.classList).forEach((t=>{t.startsWith(`${this.className}-`)&&e.classList.remove(t)})),e}static formats(t){const e={};return t.className.split(" ").forEach((t=>{if(t.startsWith(`${this.className}-`)){const i=t.substring(this.className.length+1);e[this.blotName]=i}})),e}format(t,e){if(t===this.blotName)if(e)this.domNode.classList.remove(`${this.className}-${this.formats()[this.blotName]}`),this.domNode.classList.add(`${this.className}-${e}`);else{const t=this.formats()[this.blotName];t&&this.domNode.classList.remove(`${this.className}-${t}`)}else super.format(t,e)}}e.ImageAlign=c,c.blotName="imageAlign",c.className="ql-image-align",c.tagName="span"},185:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(i(1)),n=i(87),s="left",l="center",a="right";e.default=class{constructor(t,e){this.applyStyle=t.aligner.applyStyle,this.quill=e.quill,this.alignments={[s]:{name:s,icon:t.icons.left,apply:t=>{this.setAlignment(t,s)}},[l]:{name:l,icon:t.icons.center,apply:t=>{this.setAlignment(t,l)}},[a]:{name:a,icon:t.icons.right,apply:t=>{this.setAlignment(t,a)}}}}getAlignments(){return Object.keys(this.alignments).map((t=>this.alignments[t]))}clear(t){t instanceof HTMLElement&&(t=o.default.find(t)),null!=t&&("IMG"===t.domNode.tagName?null!==t.parent&&"SPAN"===t.parent.domNode.tagName&&t.parent.format(n.ImageAlign.blotName,!1):"IFRAME"===t.domNode.tagName&&t.format(n.IframeAlignClass.attrName,!1))}isAligned(t,e){if("IMG"===t.tagName){const i=`${n.ImageAlign.className}-${e.name}`,r=t.parentElement;return null!==r&&"SPAN"===r.tagName&&r.classList.contains(i)}if("IFRAME"===t.tagName){const i=`${n.IframeAlignClass.keyName}-${e.name}`;return t.classList.contains(i)}return!1}setAlignment(t,e){let i=o.default.find(t);if(null!=i){const r=this.isAligned(t,this.alignments[e]);this.clear(i),"IMG"!==t.tagName||r?"IFRAME"!==t.tagName||r||i.format(n.IframeAlignClass.attrName,this.alignments[e].name):i.format(n.ImageAlign.blotName,this.alignments[e].name)}}}},320:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.toolbar=null,this.buttons=[]}create(t,e){const i=document.createElement("div");return i.classList.add(t.options.align.toolbar.mainClassName),this.addToolbarStyle(t,i),this.addButtons(t,i,e),this.toolbar=i,this.toolbar}destroy(){this.toolbar=null,this.buttons=[]}getElement(){return this.toolbar}addToolbarStyle(t,e){t.options.align.toolbar.mainStyle&&Object.assign(e.style,t.options.align.toolbar.mainStyle)}addButtonStyle(t,e,i){if(i.options.align.toolbar.buttonStyle&&(Object.assign(t.style,i.options.align.toolbar.buttonStyle),e>0&&(t.style.borderLeftWidth="0")),i.options.align.toolbar.svgStyle){const e=t.children[0];e&&Object.assign(e.style,i.options.align.toolbar.svgStyle)}}addButtons(t,e,i){i.getAlignments().forEach(((r,o)=>{const n=document.createElement("span");n.classList.add(t.options.align.toolbar.buttonClassName),n.innerHTML=r.icon,n.addEventListener("click",(()=>{this.onButtonClick(n,t,r,i)})),this.preselectButton(n,r,t,i),this.addButtonStyle(n,o,t),this.buttons.push(n),e.appendChild(n)}))}preselectButton(t,e,i,r){if(!i.currentSpec)return;const o=i.currentSpec.getTargetElement();o&&r.isAligned(o,e)&&this.selectButton(i,t)}onButtonClick(t,e,i,r){if(!e.currentSpec)return;const o=e.currentSpec.getTargetElement();o&&this.clickButton(t,o,e,i,r)}clickButton(t,e,i,r,o){this.buttons.forEach((t=>{this.deselectButton(i,t)})),o.isAligned(e,r)?i.options.align.toolbar.allowDeselect?o.clear(e):this.selectButton(i,t):(this.selectButton(i,t),r.apply(e)),i.update()}selectButton(t,e){e.classList.add("is-selected"),t.options.align.toolbar.addButtonSelectStyle&&e.style.setProperty("filter","invert(20%)")}deselectButton(t,e){e.classList.remove("is-selected"),t.options.align.toolbar.addButtonSelectStyle&&e.style.removeProperty("filter")}}},156:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.IframeVideoSpec=e.UnclickableBlotSpec=e.ImageSpec=e.BlotSpec=e.ResizeAction=e.DeleteAction=e.DefaultToolbar=e.DefaultAligner=e.AlignAction=e.Action=e.default=e.DefaultOptions=void 0;var o=i(402);Object.defineProperty(e,"DefaultOptions",{enumerable:!0,get:function(){return r(o).default}});var n=i(797);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return r(n).default}});var s=i(572);Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return r(s).default}});var l=i(737);Object.defineProperty(e,"AlignAction",{enumerable:!0,get:function(){return r(l).default}});var a=i(185);Object.defineProperty(e,"DefaultAligner",{enumerable:!0,get:function(){return r(a).default}});var c=i(320);Object.defineProperty(e,"DefaultToolbar",{enumerable:!0,get:function(){return r(c).default}});var u=i(751);Object.defineProperty(e,"DeleteAction",{enumerable:!0,get:function(){return r(u).default}});var d=i(108);Object.defineProperty(e,"ResizeAction",{enumerable:!0,get:function(){return r(d).default}});var h=i(601);Object.defineProperty(e,"BlotSpec",{enumerable:!0,get:function(){return r(h).default}});var f=i(329);Object.defineProperty(e,"ImageSpec",{enumerable:!0,get:function(){return r(f).default}});var m=i(260);Object.defineProperty(e,"UnclickableBlotSpec",{enumerable:!0,get:function(){return r(m).default}});var p=i(643);Object.defineProperty(e,"IframeVideoSpec",{enumerable:!0,get:function(){return r(p).default}})},601:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(i(737)),n=r(i(108)),s=r(i(751));e.default=class{constructor(t){this.formatter=t}init(){}getActions(){return[new o.default(this.formatter),new n.default(this.formatter),new s.default(this.formatter)]}getTargetElement(){return null}getOverlayElement(){return this.getTargetElement()}setSelection(){this.formatter.quill.setSelection(null)}onHide(){}}},643:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(i(260));class n extends o.default{constructor(t){super(t,"iframe.ql-video")}}e.default=n},329:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(i(601));class n extends o.default{constructor(t){super(t),this.onClick=t=>{const e=t.target;e instanceof HTMLElement&&"IMG"===e.tagName&&(this.img=e,this.formatter.show(this))},this.img=null}init(){this.formatter.quill.root.addEventListener("click",this.onClick)}getTargetElement(){return this.img}onHide(){this.img=null}}e.default=n},260:function(t,e,i){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(i(601)),n="data-blot-formatter-unclickable-bound";class s extends o.default{constructor(t,e){super(t),this.onTextChange=()=>{Array.from(document.querySelectorAll(this.selector)).filter((t=>!t.hasAttribute(n))).forEach((t=>{t.setAttribute(n,"true"),t.addEventListener("mouseenter",this.onMouseEnter)}))},this.onMouseEnter=t=>{const e=t.target;e instanceof HTMLElement&&(this.nextUnclickable=e,this.repositionProxyImage(this.nextUnclickable))},this.onProxyImageClick=()=>{this.unclickable=this.nextUnclickable,this.nextUnclickable=null,this.formatter.show(this),this.hideProxyImage()},this.selector=e,this.unclickable=null,this.nextUnclickable=null}init(){document.body&&document.body.appendChild(this.createProxyImage()),this.hideProxyImage(),this.proxyImage.addEventListener("click",this.onProxyImageClick),this.formatter.quill.on("text-change",this.onTextChange)}getTargetElement(){return this.unclickable}getOverlayElement(){return this.unclickable}onHide(){this.hideProxyImage(),this.nextUnclickable=null,this.unclickable=null}createProxyImage(){const t=document.createElement("canvas"),e=t.getContext("2d");return e&&(e.globalAlpha=0,e.fillRect(0,0,1,1)),this.proxyImage=document.createElement("img"),this.proxyImage.src=t.toDataURL("image/png"),this.proxyImage.classList.add("blot-formatter__proxy-image"),Object.assign(this.proxyImage.style,{position:"absolute",margin:"0"}),this.proxyImage}hideProxyImage(){Object.assign(this.proxyImage.style,{display:"none"})}repositionProxyImage(t){const e=t.getBoundingClientRect();Object.assign(this.proxyImage.style,{display:"block",left:`${e.left+window.pageXOffset}px`,top:`${e.top+window.pageYOffset}px`,width:`${e.width}px`,height:`${e.height}px`})}}e.default=s},1:e=>{e.exports=t}},i={};function r(t){var o=i[t];if(void 0!==o)return o.exports;var n=i[t]={exports:{}};return e[t].call(n.exports,n,n.exports,r),n.exports}return r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(156)})()));